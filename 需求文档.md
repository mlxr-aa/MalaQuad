下面是在"Vue Web应用"基础上，加入"序幕（第0幕）"后的精简功能需求文档更新版。

一、产品概述
- 名称：麻辣四格
- 形态：Web 前端应用
- 目标：用"序幕 + 四图四文（1设定、2冲突、3转折、4尾声HE）"快速验证短剧题材；尾幕固定二人幸终
- 平台：Web 浏览器，支持移动端和桌面端
- 技术栈：Vue 3 + Vite + Vue Router（hash）+ Pinia

二、范围（MVP）
- 结构：共 5 幕
  - 幕0：序幕（标题、章节名、副标题/一句话简介、背景说明、作者/标签等）
  - 幕1：设定（图+文）
  - 幕2：冲突（图+文）
  - 幕3：转折（图+文）
  - 幕4：尾声（图+文，需明确二人幸终）
- 每幕内容
  - 序幕：以文本为主，可选展示1张主题图（封面）；支持多字段
  - 幕1–4：每幕1张图片 + 1段文本
- 导航方式
  - 上一幕/下一幕按钮（按顺序阅读）
  - 滑动手势（左右）
  - 键盘 ← →（桌面调试）
- 进度指示：5 个进度点（仅展示，不可跳读到未解锁幕）
- 主题
  - 可切换主题包（每主题固定 序幕 + 4 图 4 文）
  - 切换主题后从序幕（幕0）开始
- 偏好存储：记住主题与字号（localStorage）
- 响应式：竖屏优先，横屏可用
- 兼容：现代Web浏览器，支持移动端和桌面端

三、编辑与导入导出（增强项，纳入首版）
- 编辑器
  - 序幕表单字段：title、chapter、subtitle/oneLine、background、author、tags、coverImage（可选）
  - 幕1–4：上传图片/填URL + 文本输入
  - 实时预览（序幕与各幕统一预览区）
- 导入：选择 JSON 文件或粘贴 JSON 文本加载主题
- 导出：导出纯 JSON（图片 URL）；可选导出 Base64 或 ZIP（二选一）
- 草稿：IndexedDB 自动保存与恢复（含序幕字段与本地图片 Blob）

四、素材与 JSON 规范
- 图片（非序幕封面）
  - 数量：4 张（幕1–4）
  - 比例：16:9 优先；最短边 ≥ 1080px；单张 ≤ 500KB；JPG/WEBP
- 序幕封面（可选）
  - 1 张，建议 16:9，规格同上
- 文本
  - 幕1–4每段 ≤ 120字，建议 40–90字；UTF-8
  - 序幕字段建议：title ≤ 30字；subtitle/oneLine ≤ 50字；background ≤ 200字
- JSON 结构（新增 prelude）
  - id: string
  - title: string（主题显示名，可与 prelude.title 一致或冗余）
  - prelude: {
      title: string,            // 标题
      chapter?: string,         // 章节名
      subtitle?: string,        // 副标题或一句话简介
      background?: string,      // 背景/设定说明
      coverImage?: string,      // 封面图（可选）
      author?: string,
      tags?: string[]
    }
  - images: [string, string, string, string] // 幕1–4
  - scenes: {
      scene1: string,
      scene2: string,
      scene3: string,
      epilogue: string          // 必含“二人幸终”或同义明确表述
    }
  - meta?: { locale?: string, createdAt?: string, extra?: Record<string, any> }

JSON 示例
{
  "id": "theme-id",
  "title": "麻辣四格·示例",
  "prelude": {
    "title": "风从巷口来",
    "chapter": "第1章 · 初遇",
    "subtitle": "爱与辣的故事，从一碗粉开始",
    "background": "南城老街的小馆，哪碗粉都要加一勺自制椒油。他与她在雨天相遇，各有心事，却都被这股麻辣唤醒。",
    "coverImage": "cover.jpg",
    "author": "你",
    "tags": ["都市", "甜"]
  },
  "images": ["1.jpg","2.jpg","3.jpg","4.jpg"],
  "scenes": {
    "scene1": "……",
    "scene2": "……",
    "scene3": "……",
    "epilogue": "……（二人幸终）"
  },
  "meta": { "locale": "zh-CN" }
}

五、UI 与交互
- 顶部栏
  - Logo/标题（麻辣四格）
  - 主题选择器
  - 字号切换（1/1.2）
  - 编辑入口
- 主区
  - 序幕样式：封面图（可选，16:9）、标题/章节/副标题、背景说明卡片
  - 幕1–4：图片（16:9 自适应）+ 文案卡片（高对比）
- 底部栏
  - 上一幕/下一幕按钮（≥44px）
  - 进度点（5 个）
- 行为约束
  - 禁止跳读：按顺序；可返回任一已解锁幕
  - 动画过渡 ≤ 200ms（淡入/位移）
- 错误反馈
  - 图片加载失败占位 + 重试按钮（序幕封面与幕1–4通用）

六、性能与稳定
- 首屏可交互 < 2s（本地打包资源）
- 预加载
  - 从当前幕预加载下一幕图片
  - 序幕进入后预加载幕1图片
- 稳定性
  - 无控制台错误
  - 网络失败可回退到本地示例主题（可选）

七、状态与存储
- appState（Pinia）
  - index: 0..4（0 为序幕）
  - themeId: string
  - fontScale: 1 | 1.2
  - unlockedMax: number（记录已解锁的最大幕，默认 0）
- 本地存储
  - localStorage：themeId、fontScale
  - IndexedDB：编辑器草稿与本地图片 Blob

八、Web 应用要求
- 平台：现代Web浏览器
- 路由：hash 模式
- 资源：静态资源打包；可选远端主题（需网络权限）
- 功能：基础Web功能；如需分享/文件存取，使用Web API

九、验收标准
- 导航包括序幕在内顺滑切换，共 5 幕
- 第四幕（尾声）文本包含“二人幸终”明确表述
- 主题切换后回到序幕；刷新/重启保留主题与字号
- 图片失败占位与重试可用；下一幕预加载生效（序幕→幕1也生效）
- 编辑器可创建含序幕的主题、导入/导出 JSON；草稿离线保存
- Web应用运行稳定，无报错与白屏

十、排期（7 天建议）
- D1：视觉与信息架构（加入序幕）、JSON 规范与示例主题更新
- D2：静态 UI（序幕样式、Reader/Editor 响应式）
- D3：导航与状态管理（含 unlockedMax）、存储
- D4：主题加载、图片预/懒加载、错误处理（含序幕封面）
- D5：Web应用优化与跨浏览器测试
- D6：编辑器扩展（序幕字段、校验、草稿、导入导出）
- D7：联测与发布、README 与主题制作指南更新

十一、补充规则与校验
- 校验点
  - 序幕：title 必填；background 字数 ≤ 500；coverImage 可选
  - 幕1–4：图片4张齐全；每段 ≤ 500字
  - epilogue 必须包含“二人幸终”或同义词（可用正则包含“幸终|HE|Happy End”等，最终以“二人幸终”为主）
- 交互细节
  - 进入主题时 index=0；next() 才能逐步解锁，unlockedMax 跟随递增
  - 进度点仅可回到 ≤ unlockedMax 的幕，禁向未来幕跳转

需要我把编辑器字段、JSON 校验规则或 Reader 的状态流转图补上吗？我也可以生成一页“序幕+四幕”的交互示意图或提供最小代码骨架。